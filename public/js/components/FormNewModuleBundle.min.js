Vue.component("formFieldBoolean",{template:"#formFieldBoolean-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"Field Boolean",fielApiID:"field_boolean",title:null,form_custom_data_id:null,checkboxes:[{label:"Option",checked:!0}]}},methods:{addOption(e){this.checkboxes.push({label:"Option",checked:!0})},setOption(e){},removeOption(e){this.checkboxes.splice(e,1)},convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldPlaceholder:this.fieldPlaceholder,fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id,checkboxes:JSON.stringify(this.checkboxes)}},getContentData(){return{bolean:this.checkboxes}}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.checkboxes=this.fieldData.form_value.bolean.map(e=>({label:e.label,checked:"true"===e.checked})))}))}}),Vue.component("formFieldDate",{template:"#formFieldDate-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"Field Date",fielApiID:"field_date",fielFormat:"yyyy-mm-dd",date:null,form_custom_data_id:null}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldPlaceholder:this.fieldPlaceholder,fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id,fielFormat:this.fielFormat}},getContentData(){return{date:this.date}},setDate(){let e=document.getElementById(this.fieldID).value;this.date=e},init(){setTimeout(()=>{var e=document.querySelectorAll(".datepicker");M.Datepicker.init(e,{format:this.fielFormat||"yyyy-mm-dd"})[0].setDate(new Date(this.date))},2e3)}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.date=this.fieldData.form_value.date),this.init()}))}}),Vue.component("formFieldNumber",{template:"#formFieldNumber-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"",fielApiID:"",number:null,form_custom_data_id:null}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldPlaceholder:this.fieldPlaceholder,fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id}},getContentData(){return{number:this.number}},init(){setTimeout(()=>{var e=document.querySelectorAll(".datepicker");M.Datepicker.init(e,{format:"yyyy-mm-dd"})},1e3)}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.title=this.fieldData.form_value.title),this.init()}))}}),Vue.component("formFieldSelect",{template:"#formFieldselect-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"Field select",fielApiID:"field_select",selectValue:null,selectOptions:[{label:"Option 1",value:0},{label:"Option 2",value:1},{label:"Option 3",value:2}],form_custom_data_id:null}},watch:{selectOptions:function(e){this.updateSelect()}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},updateSelect(){var e=document.getElementById(this.fieldID);e&&(e.M_FormSelect&&e.M_FormSelect.destroy(),setTimeout(()=>{M.FormSelect.init(e,{});console.log("select updated")},1e3))},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id,selectOptions:JSON.stringify(this.selectOptions)}},addOption(){this.selectOptions.push({label:"New Option",value:"0"})},setOption(e){e.value=e.label,this.updateSelect()},removeOption(e){this.selectOptions.splice(e,1),this.updateSelect()},getContentData(){return{dropdown_select:this.selectValue}},init(){setTimeout(()=>{this.updateSelect();var e=document.getElementById("collapsible"+this.fieldID);M.Collapsible.init(e,{accordion:!1})},1e3)}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.selectValue=this.fieldData.form_value.dropdown_select),this.init()}))}}),Vue.component("formFieldTextArea",{template:"#formFieldTextArea-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{form_field_id:null,fieldID:this.makeid(10),fieldName:"",fielApiID:"",text:null,form_custom_data_id:null,fieldPlaceholder:""}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,"")},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id}},getContentData(){return{text:this.text}}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.text=this.fieldData.form_value.text)}))}}),Vue.component("formFieldTime",{template:"#formFieldTime-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"Field Time",fielApiID:"field_time",time:null,form_custom_data_id:null}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldPlaceholder:this.fieldPlaceholder,fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id}},getContentData(){return{time:this.time}},setTime(){let e=document.getElementById(this.fieldID).value;this.time=e},init(){setTimeout(()=>{var e=document.querySelectorAll(".timepicker");M.Timepicker.init(e,{twelveHour:!1})},2e3)}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.time=this.fieldData.form_value.time),this.init()}))}}),Vue.component("formFieldTitle",{template:"#formFieldTitle-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{fieldPlaceholder:"",form_field_id:null,fieldID:this.makeid(10),fieldName:"",fielApiID:"",title:null,form_custom_data_id:null}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldPlaceholder:this.fieldPlaceholder,fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id}},getContentData(){return{title:this.title}}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.title=this.fieldData.form_value.title)}))}}),Vue.component("formImageSelector",{template:"#formImageSelector-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{form_field_id:null,fieldID:this.makeid(10),fieldName:"Agregar Imagen",fielApiID:"file_imagen",text:null,form_custom_data_id:null,fieldPlaceholder:"",preselected:[],mode:"files",filter:"images",multiple:!1}},methods:{getPageImagePath:e=>e.get_full_file_path()?e.get_full_file_path():BASEURL+"public/img/default.jpg",removeItemImage(e){this.preselected.splice(e,1)},convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,"")},copyCallcack(e){e=e.map(e=>new ExplorerFile(e)),this.preselected=e,M.Modal.getInstance($(".modal")).close(),setTimeout(()=>{var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{});e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{});e=document.querySelectorAll(".materialboxed");M.Materialbox.init(e,{})},3e3)},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},getData(){return{fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id,mode:this.mode,filter:this.filter,multiple:this.multiple}},getContentData(){return{image:this.preselected}}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.preselected=this.fieldData.form_value.image.map(e=>new ExplorerFile(e))),"1"==this.multiple?this.multiple=!0:this.multiple=!1}))}}),Vue.component("formTextFormat",{template:"#formTextFormat-template",props:["tab-parent","field-ref","field-ref-index","serveData","configurable","fieldData"],data:function(){return{form_field_id:null,fieldID:"text_format_"+this.makeid(10),fieldName:"text_format",fielApiID:"text_format_"+this.makeid(4),text:null,form_custom_data_id:null,fieldPlaceholder:""}},methods:{makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,"")},getData(){return{fieldID:this.fieldID,fieldName:this.fieldName,fielApiID:this.fielApiID,form_custom_data_id:this.form_custom_data_id}},getContentData(){return{formatText:this.text}},init(){setTimeout(()=>{tinymce.init({selector:"#"+this.fieldID,plugins:["link table code"],setup:e=>{e.on("Change",e=>{this.text=tinymce.editors[this.fieldID].getContent()})}})},2e3)}},mounted:function(){this.$nextTick((function(){for(const e in this.serveData)if(this.serveData.hasOwnProperty(e)){const t=this.serveData[e];this[e]=t}this.fieldData&&(this.form_field_id=this.fieldData.form_field_id,this.form_custom_data_id=this.fieldData.form_custom_data_id,this.text=this.fieldData.form_value.text),this.init()}))}});var FormNewModule=new Vue({el:"#root",data:{debug:DEBUGMODE,editMode:!1,loader:!0,form_name:"Nuevo Formulario",form_description:"",date_create:null,date_update:null,user:{},status:!0,tabs:[],custom_model_id:null,formsElements:formsElements,configurable:!0},methods:{getInitialTab(){return{tab_name:"Tab "+(this.tabs.length+1),tabID:this.makeid(10),form_tab_id:null,form_fields:[],edited:!0,active:!0,status:!0}},setActive(e){this.tabs.map(e=>(e.active=!1,e)),this.tabs[e].active=!0},addTab(){this.debug&&console.log("addTab trigger"),this.tabs.push(this.getInitialTab()),this.setActive(this.tabs.length-1)},saveTab(e){this.debug&&console.log("saveTab trigger"),this.tabs[e].edited=!1},makeid(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=i.length,l=0;l<e;l++)t+=i.charAt(Math.floor(Math.random()*a));return t},deleteTab(e){if(this.debug&&console.log("deleteTab trigger"),1==this.tabs.length)return!1;this.tabs.splice(e,1)},getActiveTab(){let e;return this.tabs.forEach((t,i)=>{t.active&&(e=i)}),e},addField(e){this.debug&&console.log("addField trigger"),this.tabs[this.getActiveTab()].form_fields.push(JSON.parse(JSON.stringify(e))),setTimeout(()=>{var e=document.querySelectorAll(".collapsible");M.Collapsible.init(e,{});e=document.querySelectorAll(".tooltipped"),M.Tooltip.init(e,{});M.AutoInit()},2e3)},removeField(e,t){"formTextFormat"==this.tabs[e].form_fields[t].component?(this.getfieldsData(),editor=this.tabs[e].form_fields[t].data,tinymce.editors[editor.fieldID].destroy(),this.tabs[e].form_fields.splice(t,1)):this.tabs[e].form_fields.splice(t,1)},getfieldsData(){this.debug&&console.log("getfieldsData trigger"),fieldsComponents=FormNewModule.$refs;for(const e in fieldsComponents)if(fieldsComponents.hasOwnProperty(e)){const t=fieldsComponents[e];for(let e=0;e<t.length;e++){const i=t[e];FormNewModule.setFieldData(i.tabParent.tabID,i.fieldRefIndex,JSON.parse(JSON.stringify(i.getData())))}}},setFieldData(e,t,i){this.debug&&console.log("setFieldData trigger"),this.tabs.map(a=>{a.tabID==e&&(a.form_fields[t].data=i)})},getFormData(){return this.getfieldsData(),{custom_model_id:this.custom_model_id,form_name:this.form_name,form_description:this.form_description,date_create:this.date_create,date_update:this.date_update,status:this.status?1:0,user:this.user,tabs:this.tabs}},saveData(){$("html, body").animate({scrollTop:0},600),this.loader=!0,this.debug&&console.log("saveData trigger");var e=this.getFormData(),t=BASEURL+"api/v1/forms",i=this;$.ajax({type:"POST",url:t,data:{data:JSON.stringify(e)},dataType:"json",success:function(e){i.debug&&console.log(t,e),e.data&&(i.custom_model_id=e.data.custom_model_id,i.editMode=!0,i.loader=!1,M.toast({html:`<span>Formulario Guardado</span> <a class="btn-flat toast-action" href="${BASEURL+"admin/custommodels/addData/"+i.custom_model_id}"> Agregar Data</a>`}))},error:function(e){i.loader=!1,M.toast({html:e.error_message})}})},checkEditMode(){if("undefined"!=typeof custom_model_id){this.editMode=!0,this.custom_model_id=custom_model_id,console.log("editMode",this.editMode);var e=this,t=BASEURL+"api/v1/models/"+custom_model_id;$.ajax({type:"GET",url:t,data:{},dataType:"json",success:function(i){e.debug&&console.log(t,i),"200"==i.code&&e.updateFormData(i.data)},error:function(t){e.loader=!1,M.toast({html:"Ocurrió un error"})}})}else this.loader=!1},updateFormData(e){this.serverdata=e,this.form_name=e.form_name,this.form_description=e.form_description,this.date_create=e.date_create,this.date_update=e.date_update,this.status="1"==e.status,this.user=e.user,this.tabs=e.tabs.map((e,t)=>({edited:!1,active:!1,tab_name:e.tab_name,status:"1"==e.status,form_tab_id:e.form_tab_id,form_fields:e.form_fields?e.form_fields:[],tabID:this.makeid(10)})),this.tabs[0].active=!0,setTimeout(()=>{var e=document.querySelectorAll(".collapsible");M.Collapsible.init(e,{}),this.loader=!1},2e3)}},mounted:function(){this.$nextTick((function(){this.debug&&console.log("FormNewModule mounted"),this.tabs.push(this.getInitialTab()),this.tabs[0].edited=!1,this.checkEditMode()}))}});