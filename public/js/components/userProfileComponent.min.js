Vue.component("formCustom",{template:"#form-custom-template",props:["form"],data:function(){return{debug:DEBUGMODE}},mixins:[mixins],methods:{},mounted:function(){this.$nextTick((function(){}))}}),Vue.component("pageCard",{template:"#page-card-template",props:["page"],data:function(){return{debug:DEBUGMODE}},mixins:[mixins],methods:{getcontentText:function(e){var t=document.createElement("span");return t.innerHTML=e.content,(t.textContent||t.innerText).substring(0,220)+"..."},getPageImagePath(){return this.imagen_file?BASEURL+this.imagen_file.file_path.substr(2)+this.imagen_file.file_name+"."+this.imagen_file.file_type:"https://materializecss.com/images/sample-1.jpg"},getPageFullPath:function(e){return 1==e.status?BASEURL+e.path:BASEURL+"admin/paginas/editar/"+e.page_id}},mounted:function(){this.$nextTick((function(){}))}});var userProfile=new Vue({el:"#root",data:{debug:DEBUGMODE,loader:!0,user:new User,timelineData:[]},mixins:[mixins],watch:{"user.user_id":function(e){$("#input-100").data("fileinput")&&($("#input-100").data("fileinput").uploadExtraData.curDir="./public/img/profile/"+this.user.username+"/")}},filters:{shortDate:function(e){return e.split("at")[0]}},methods:{getUser(){var e=this;e.loader=!0,e.users=[];var t=window.location.pathname.split("/")[4];if(t){var a=BASEURL+"api/v1/users/"+t;fetch(a).then(e=>e.json()).then(t=>{e.debug&&console.log(a,t),e.loader=!1,e.user=new User(t.data)}).catch(t=>{M.toast({html:t.responseJSON.error_message}),e.loader=!1})}},getUserTimeline(){var e=this;e.timelineData=[];var t=window.location.pathname.split("/")[4];if(t){var a=BASEURL+"/api/v1/users/timeline/"+t;fetch(a).then(e=>e.json()).then(t=>{e.debug&&console.log(a,t),e.loader=!1;let i=t.data.map((e,t)=>{switch(e.model_type){case"page":return new Page(e)}return e}),n={};i.forEach(e=>{let t=e.date_create.split(" ")[0]+" 00:00:00";null==n[t]&&(n[t]=[]),n[t].push(e)}),e.timelineData=n}).catch(t=>{M.toast({html:response.responseJSON.error_message}),e.loader=!1})}},updateAvatar(){var e=this;e.loader=!0,$.ajax({type:"POST",url:BASEURL+"api/v1/users/avatar",data:{avatar:e.user.user_data.avatar,user_id:e.user.user_id},dataType:"json",success:function(t){e.loader=!1},error:function(t){M.toast({html:response.responseJSON.error_message}),e.loader=!1}})},base_url:function(e){return BASEURL+e},getAvatarUrl(e){return this.base_url("public/img/profile/"+this.user.username+"/"+e)},initPlugins:function(){M.Tabs.init(document.getElementById("user-tabs"),{}),setTimeout(()=>{var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{});e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{})},4e3)}},mounted:function(){this.$nextTick((function(){this.getUser(),this.getUserTimeline(),this.initPlugins(),window.uploadCallback=(e,t,a,i)=>{console.log(i),this.user.user_data.avatar=i.substring(i.indexOf("_")+1),this.updateAvatar(),M.toast({html:"File Uploaded!"}),M.Modal.getInstance($("#modal1")).close()},fileUploaderModule.multiple=!1,fileUploaderModule.callBakSelectedImagen=e=>{console.log(e);let t=e[0];userProfile.user.user_data.avatar=t.file_name+"."+t.file_type,fileUploaderModule.copyFileTo(e[0],"./public/img/profile/"+this.user.username+"/",(function(e){200==e.code&&(userProfile.updateAvatar(),M.toast({html:"<span>Done! </span>"}))}))}}))}});