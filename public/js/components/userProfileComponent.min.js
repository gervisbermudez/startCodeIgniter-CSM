var userProfile=new Vue({el:"#root",data:{debug:DEBUGMODE,loader:!0,user:{user_id:null}},watch:{"user.user_id":function(e){$("#input-100").data("fileinput")&&($("#input-100").data("fileinput").uploadExtraData.curDir="./public/img/profile/"+this.user.username+"/")}},methods:{getUser(){var e=this;e.loader=!0,e.users=[];var a=window.location.pathname.split("/")[4];if(a){var t=BASEURL+"api/v1/users/"+a;$.ajax({type:"GET",url:t,data:{},dataType:"json",success:function(a){e.debug&&console.log(t,a),e.loader=!1,e.user=a.data},error:function(a){M.toast({html:response.responseJSON.error_message}),e.loader=!1}})}},updateAvatar(){var e=this;e.loader=!0,$.ajax({type:"POST",url:BASEURL+"api/v1/users/avatar",data:{avatar:e.user.user_data.avatar,user_id:e.user.user_id},dataType:"json",success:function(a){e.loader=!1},error:function(a){M.toast({html:response.responseJSON.error_message}),e.loader=!1}})},base_url:function(e){return BASEURL+e},getAvatarUrl(e){return this.base_url("public/img/profile/"+this.user.username+"/"+e)},initPlugins:function(){setTimeout(()=>{var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{}),e=document.querySelectorAll(".dropdown-trigger"),M.Dropdown.init(e,{})},3e3)}},mounted:function(){this.$nextTick((function(){this.getUser(),this.initPlugins(),window.uploadCallback=(e,a,t,r)=>{console.log(r),this.user.user_data.avatar=r.substring(r.indexOf("_")+1),this.updateAvatar(),M.toast({html:"File Uploaded!"}),M.Modal.getInstance($("#modal1")).close()},fileUploaderModule.multiple=!1,fileUploaderModule.callBakSelectedImagen=e=>{console.log(e);let a=e[0];userProfile.user.user_data.avatar=a.file_name+"."+a.file_type,fileUploaderModule.copyFileTo(e[0],"./public/img/profile/"+this.user.username+"/",(function(e){200==e.code&&(userProfile.updateAvatar(),M.toast({html:"<span>Done! </span>"}))}))}}))}});