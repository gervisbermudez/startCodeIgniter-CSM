Vue.component("formFieldTitle",{template:"#formFieldTitle-template",props:["tab-parent","field-ref","field-ref-index"],data:function(){return{fieldPlaceholder:"",fieldID:this.makeid(10),fieldName:"",fielApiID:""}},methods:{convertfielApiID(){this.fielApiID=this.fieldName.toLowerCase().replace(/ /g,"_").replace(/[^\w-]+/g,""),this.fieldPlaceholder=this.fieldName.toLowerCase()},makeid(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=a.length,s=0;s<e;s++)t+=a.charAt(Math.floor(Math.random()*i));return t}}});var formModule=new Vue({el:"#formModule",data:{debug:!0,tabs:[],formsElements:[{name:"title",displayName:"Titulo",icon:"format_color_text",component:"formFieldTitle"},{name:"formatText",displayName:"Texto con formato",icon:"format_size"},{name:"image",displayName:"Imagen",icon:"image"},{name:"link",displayName:"Link",icon:"insert_link"},{name:"date",displayName:"Fecha",icon:"date_range"},{name:"timestamp",displayName:"Fecha y Hora",icon:"access_time"},{name:"number",displayName:"Numero",icon:"looks_one"},{name:"dropdown_select",displayName:"Select",icon:"list"},{name:"bolean",displayName:"Bolean",icon:"check_circle"}],form_name:"Nuevo Formulario",form_status:!0},methods:{getInitialTab(){return{name:"Tab "+(this.tabs.length+1),tabID:this.makeid(10),edited:!0,active:!0,fields:[]}},setActive(e){this.tabs.map(e=>(e.active=!1,e)),this.tabs[e].active=!0},addTab(){this.debug&&console.log("addTab trigger"),this.tabs.push(this.getInitialTab()),this.setActive(this.tabs.length-1)},saveTab(e){this.debug&&console.log("saveTab trigger"),this.tabs[e].edited=!1},makeid(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=a.length,s=0;s<e;s++)t+=a.charAt(Math.floor(Math.random()*i));return t},deleteTab(e){if(this.debug&&console.log("deleteTab trigger"),1==this.tabs.length)return!1;this.tabs.splice(e,1)},getActiveTab(){let e;return this.tabs.forEach((t,a)=>{t.active&&(e=a)}),e},addField(e){this.debug&&console.log("addField trigger"),this.tabs[this.getActiveTab()].fields.push(JSON.parse(JSON.stringify(e))),setTimeout(()=>{var e=document.querySelectorAll(".collapsible");M.Collapsible.init(e,{})},2e3)},getfieldsData(){this.debug&&console.log("getfieldsData trigger"),fieldsComponents=formModule.$refs;for(const e in fieldsComponents)if(fieldsComponents.hasOwnProperty(e)){const t=fieldsComponents[e];for(let e=0;e<t.length;e++){const a=t[e];formModule.setFieldData(a.tabParent.tabID,a.fieldRefIndex,JSON.parse(JSON.stringify(a.$data)))}}},setFieldData(e,t,a){this.debug&&console.log("setFieldData trigger"),this.tabs.map(i=>{i.tabID==e&&(i.fields[t].data=a)})},saveData(){this.debug&&console.log("saveData trigger"),this.getfieldsData();let e={form_name:this.form_name,form_status:this.form_status,tabs:{}};this.tabs.forEach(t=>{e.tabs[t.name]={data:JSON.parse(JSON.stringify(t.fields))}}),console.log(e),$.ajax({type:"POST",url:BASEURL+"admin/formularios/saveForm",data:e,dataType:"json",success:function(e){console.log(e)}})}},mounted:function(){this.$nextTick((function(){this.debug&&console.log("formModule mounted"),this.tabs.push(this.getInitialTab()),this.tabs[0].edited=!1,$((function(){$("#simple-list").dragsort()}))}))}});