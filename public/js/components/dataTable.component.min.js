var dataTable=Vue.component("dataTable",{template:"#dataTableComponent-template",props:{endpoint:{type:String,required:!1},index_data:{type:String,required:!1},hideids:{type:Boolean,default:!1},colums:{type:Array,required:!1,default:null},pagination:{type:Boolean,required:!1,default:!1},module:{type:String,required:!1}},data:function(){return{data:[],showPagination:!1,paginator:{},paginatorLinks:[],labels:[{colum:"name",label:"Name"}],statusIcons:[{tooltip:"No permitido",icon:"not_interested"},{tooltip:"Permitido",icon:"publish"}],tableView:!1,loader:!0,filter:"",orderDataConf:{strPropertyName:null,sort_as:"asc"}}},mixins:[mixins],computed:{filterData:function(){if(this.filter){let t=this.filter.toLowerCase();return this.data.filter((e,i)=>this.searchInObject(e,t))}return this.data}},methods:{toggleView:function(){this.tableView=!this.tableView,this.initPlugins()},set_paginatorLinks:function(){if(this.showPagination){let t=[];t.push({page:this.paginator.prev_page,label:'<i class="material-icons">chevron_left</i>',class:0==this.paginator.prev_page?"disabled":"waves-effect"});for(let e=1;e<=this.paginator.total_pages;e++)t.push({page:e,label:e,class:this.paginator.current_page==e?"active":"waves-effect"});return t.push({page:this.paginator.next_page,label:'<i class="material-icons">chevron_right</i>',class:this.paginator.next_page>this.paginator.total_pages?"disabled":"waves-effect"}),this.paginatorLinks=t}return null},toggleEddit(t){t.editable=!t.editable,this.$forceUpdate()},resetFilter:function(){this.filter=""},pagerTo(t){this.getData(t)},initPlugins:function(){setTimeout(()=>{var t=document.querySelectorAll(".tooltipped");M.Tooltip.init(t,{});t=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(t,{});t=document.querySelectorAll(".collapsible");M.Collapsible.init(t,{});t=document.querySelectorAll("select");M.FormSelect.init(t,{})},3e3)},getData:function(t=1){var e=this;if(e.loader=!0,this.pagination)var i=BASEURL+this.endpoint+"?page="+t;else i=BASEURL+this.endpoint;fetch(i).then(t=>t.json()).then(t=>{let i=t.data;i.map(t=>(t.user?t.user=new User(t.user):t.user=new User({}),t)),i.length&&!this.colums&&(this.labels=Object.keys(i[0]),this.hideids&&(this.labels=this.labels.filter(t=>-1==t.indexOf("_id"))),this.colums=this.labels.map(t=>({colum:t,label:t}))),t.current_page&&this.pagination&&(this.showPagination=!0,this.paginator.current_page=t.current_page,this.paginator.per_page=t.per_page,this.paginator.total_rows=t.total_rows,this.paginator.offset=t.offset,this.paginator.total_pages=t.total_pages,this.paginator.first_page=t.first_page,this.paginator.last_page=t.last_page,this.paginator.next_page=t.next_page,this.paginator.prev_page=t.prev_page,this.set_paginatorLinks()),e.data=i,e.loader=!1,this.initPlugins()}).catch(t=>{e.loader=!1})},getContent(t,e){let i=e.colum;if(e.format&&"function"==typeof e.format)return e.format(t,e);let a="";switch(i){case"user":a=`<a href="${BASEURL+t[i].get_profileurl()}">${t[i].get_fullname()}</a>`;break;case"status":a=`<span>\n                <i class="material-icons tooltipped" data-position="left" data-delay="50" data-tooltip="${this.statusIcons[t[i]].tooltip}">${this.statusIcons[t[i]].icon}</i>\n              </span>`;break;default:a=t[i]}return a},editItem(t,e){this.$listeners&&this.$listeners.edit?this.$emit("edit",{item:t,index:e}):this.$router.push({name:"edit",params:{data:{index:e,item:t}}})},createItem(){this.$router.push({name:"edit",params:{data:{mode:"new"}}})},deleteItem(t,e){this.$listeners&&this.$listeners.delete?this.$emit("delete",{item:t,index:e}):this.tempDelete(t,e)},archiveItem(t,e){return this.$listeners&&this.$listeners.archive?void this.$emit("archive",{item:t,index:e}):void 0},delete(t,e){console.log({item:t,index:e})},tempDelete:function(t,e){this.toDeleteItem.item=t,this.toDeleteItem.index=e},confirmCallback(t){t&&this.delete(this.toDeleteItem.item,this.toDeleteItem.index)},initPlugins:function(){setTimeout(()=>{var t=document.querySelectorAll(".tooltipped");M.Tooltip.init(t,{}),t=document.querySelectorAll(".dropdown-trigger"),M.Dropdown.init(t,{})},3e3)}},mounted:function(){this.$nextTick((function(){this.endpoint?this.getData():this.loader=!1,this.$root.$on("eventing",t=>{this.data[t.index]=t.item})}))}});