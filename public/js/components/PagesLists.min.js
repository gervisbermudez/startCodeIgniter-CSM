var PagesLists=new Vue({el:"#root",data:{debug:DEBUGMODE,pages:[],tableView:!0,loader:!0,filter:"",tempPage:{}},mixins:[mixins],computed:{filterPages:function(){return this.pages.filter((e,t)=>!e.path.includes("blog/"))},blogs:function(){return this.pages.filter((e,t)=>e.path.includes("blog/"))},filterAll:function(){if(this.filter){let e=this.filter.toLowerCase();return this.pages.filter((t,i)=>this.searchInObject(t,e))}return[]}},methods:{getcontentText:function(e){var t=document.createElement("span");return t.innerHTML=e.content,(t.textContent||t.innerText).substring(0,120)+"..."},toggleView:function(){this.tableView=!this.tableView,this.initPlugins()},resetFilter:function(){this.filter=""},getPageImagePath:e=>e.imagen_file?BASEURL+e.imagen_file.file_path.substr(2)+e.imagen_file.file_name+"."+e.imagen_file.file_type:BASEURL+"public/img/default.jpg",getPages:function(){var e=this;$.ajax({type:"GET",url:BASEURL+"api/v1/pages/",data:{},dataType:"json",success:function(t){e.pages=t.data,e.pages.map(e=>(e.user=new User(e.user),e)),e.loader=!1,e.initPlugins()},error:function(t){e.loader=!1,M.toast({html:"Ocurrió un error inesperado"}),console.error(t)}})},deletePage:function(e,t){var i=this;i.loader=!0,$.ajax({type:"DELETE",url:BASEURL+"api/v1/pages/"+e.page_id,data:{},dataType:"json",success:function(e){200==e.code&&i.pages.splice(t,1),i.loader=!1,i.initPlugins()},error:function(e){i.loader=!1,M.toast({html:"Ocurrió un error inesperado"}),console.error(e)}})},setTempPage:function(e,t){this.tempPage.page=e,this.tempPage.index=t},confirmDelete(e){e&&this.deletePage(this.tempPage.page,this.tempPage.index)},confirmArchive(e){e&&this.toggleArchive(this.tempPage.page,this.tempPage.index)},toggleArchive(e,t){var i=this;i.loader=!0,$.ajax({type:"POST",url:BASEURL+"api/v1/pages/archive/"+e.page_id,data:{},dataType:"json",success:function(e){200==e.code?i.pages.splice(t,1):M.toast({html:e.error_message}),i.loader=!1,i.initPlugins()},error:function(e){i.loader=!1,M.toast({html:"Ocurrió un error inesperado"}),console.error(e)}})},initPlugins:function(){setTimeout(()=>{var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{});e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{})},3e3)}},mounted:function(){this.$nextTick((function(){this.getPages()}))}});