var ConfiguracionList=new Vue({el:"#root",data:{configurations:[],tableView:!1,loader:!0,filter:""},computed:{filterConfigurations:function(){if(this.filter){let e=this.filter.toLowerCase();return this.configurations.filter((t,o)=>-1!=t.config_name.toLowerCase().indexOf(e)||-1!=t.config_value.toLowerCase().indexOf(e)||-1!=t.config_value.toLowerCase().indexOf(e)||-1!=t.config_value.toLowerCase().indexOf(e)||-1!=t.config_type.toLowerCase().indexOf(e))}return this.configurations}},methods:{toggleView:function(){this.tableView=!this.tableView,this.initPlugins()},toggleEddit(e){e.editable=!e.editable,this.$forceUpdate()},resetFilter:function(){this.filter=""},initPlugins:function(){setTimeout(()=>{var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{});e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{});e=document.querySelectorAll(".collapsible");M.Collapsible.init(e,{});e=document.querySelectorAll("select");M.FormSelect.init(e,{})},3e3)},saveConfig(e){if(this.toggleEddit(e),"boolean"!=e.config_data){let t=new VueForm({field:{value:e.config_value,required:!0,type:e.config_data.validate_as,maxLength:e.config_data.max_lenght,minLength:e.config_data.min_lenght}});t.validate(),t.errors.length>0?(e.validate=!1,M.toast({html:"Verificar la configuracion del campo"})):(e.validate=!0,this.runSave(e))}else this.runSave(e)},runSave(e){var t=this,o=BASEURL+"api/v1/config";$.ajax({type:"POST",url:o,data:e,dataType:"json",success:function(e){t.debug&&console.log(o,e),200==e.code?("function"==typeof callBack&&callBack(e),M.toast({html:"Config Saved!"})):M.toast({html:e.responseJSON.error_message})},error:function(e){M.toast({html:e.responseJSON.error_message})}})},getconfigurations:function(){var e=this,t=BASEURL+"api/v1/config/";fetch(t).then(e=>e.json()).then(t=>{let o=t.data;for(const e in o)if(o.hasOwnProperty(e)){o[e].user=new User(o[e].user);try{o[e].config_data=JSON.parse(o[e].config_data)}catch(t){o[e].config_data={}}}e.configurations=o,e.loader=!1}).catch(t=>{M.toast({html:t.responseJSON.error_message}),e.loader=!1})},deleteConfiguration:function(e,t){var o=this;o.loader=!0,$.ajax({type:"DELETE",url:BASEURL+"api/v1/configuration/"+e.configuration_id,data:{},dataType:"json",success:function(e){200==e.code&&o.configurations.splice(t,1)},error:function(e){M.toast({html:response.responseJSON.error_message}),o.loader=!1}})},base_url:function(e){return BASEURL+e}},mounted:function(){this.$nextTick((function(){this.getconfigurations()}))}});