const db=new PouchDB("mensajes");function guardarMensaje(e){return e._id=(new Date).toISOString(),db.put(e).then(()=>{self.registration.sync.register("nuevo-post");return new Response(JSON.stringify({ok:!0,offline:!0}))})}function postearMensajes(){const e=[];return db.allDocs({include_docs:!0}).then(n=>(n.rows.forEach(n=>{const t=n.doc,o=fetch("api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>db.remove(t));e.push(o)}),Promise.all(e)))}